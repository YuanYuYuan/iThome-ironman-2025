# åœ¨ Zenoh ä¸­æ©‹æ¥ Rust èˆ‡ C â€” ç¬¬ 2 éƒ¨åˆ†ï¼šä½¿ç”¨æ¨¡å¼èˆ‡å®‰å…¨æ€§

åœ¨[ç¬¬ 1 éƒ¨åˆ†](https://ithelp.ithome.com.tw/articles/10382980)ä¸­ï¼Œæˆ‘å€‘æ¢è¨äº† zenoh-c è‡ªå‹•ç¶å®šç”Ÿæˆç³»çµ±èƒŒå¾Œçš„è¤‡é›œæ¶æ§‹ï¼Œäº†è§£æ­¤å°ˆæ¡ˆå¦‚ä½•åˆ©ç”¨ compilation-based introspectionã€cbindgen èˆ‡ generic macros å¾ Rust ç¨‹å¼ç¢¼è‡ªå‹•ç”Ÿæˆ C APIã€‚

æœ¬ç¯‡é‡é»åœ¨æ–¼å¯¦å‹™ï¼šç”Ÿæˆçš„ç¶å®šå¦‚ä½•å¯¦éš›é‹ä½œï¼ŒZenoh-c ç¨ç‰¹çš„ type system å¦‚ä½•å°‡ Rust çš„ ownership semantics å¸¶å…¥ Cï¼Œä»¥åŠé€™å¥—å…ˆé€²ç³»çµ±ç„¡æ³•å®Œå…¨æ¶ˆé™¤çš„å®‰å…¨æŒ‘æˆ°ã€‚
ç¬¬ 3 éƒ¨åˆ†å°‡å±•ç¤º zenoh-cpp å¦‚ä½•å»ºåŸºæ–¼é€™å¥— C åŸºç¤ï¼Œç‚ºç¾ä»£ C++ é–‹ç™¼è€…æä¾›é€é RAII åŠ C++ å‹åˆ¥ç³»çµ±è¨­è¨ˆçš„å®‰å…¨ä¸”äººé«”å·¥å­¸çš„ APIã€‚

***

## Zenoh-C çš„ Type Systemï¼šå°‡ Ownership å¸¶å…¥ C

Zenoh-c é€éä¸€å¥—è¬¹æ…è¨­è¨ˆçš„ type systemï¼Œå°‡ Rust çš„æ‰€æœ‰æ¬Šæ¦‚å¿µæ˜ å°„ç‚º C ç´„å®šï¼Œé€™æ˜¯ç¾è¡Œå¸¶å…¥ memory safety è‡³ C API çš„æœ€è¤‡é›œå˜—è©¦ä¹‹ä¸€ã€‚

### å‹åˆ¥åˆ†é¡

Zenoh-c å°‡å‹åˆ¥çµ„ç¹”ç‚ºå¤šç¨® distinct categoriesï¼Œæ¯å€‹åœ¨æ‰€æœ‰æ¬Šæ¨¡å‹ä¸­æ“”ä»»ç‰¹å®šè§’è‰²ï¼š

- **Owned types** (`z_owned_xxx_t`)ï¼šä»£è¡¨å°ˆæœ‰æ“æœ‰æ¬Šçš„è³‡æºï¼Œé¡ä¼¼ Rust çš„ owned å€¼
- **Loaned types** (`z_loaned_xxx_t`)ï¼šä»£è¡¨å€Ÿç”¨å¼•ç”¨ï¼Œç­‰åŒæ–¼ Rust çš„ `&T`
- **Moved types** (`z_moved_xxx_t`)ï¼šå‡½å¼åƒæ•¸ä¸­è¡¨é”æ‰€æœ‰æ¬Šè½‰ç§»
- **View types** (`z_view_xxx_t`)ï¼šå †ç–Šåˆ†é…çš„æª¢è¦–ç‰©ä»¶ï¼Œä¸é ˆé¡¯å¼æ¸…é™¤
- **Option structures** (`z_xxx_options_t`)ï¼šæ“ä½œçš„é…ç½®åƒæ•¸
- **Enums åŠ plain data types** (`z_xxx_t`)ï¼šåŸºç¤å€¼å‹åˆ¥

é€™å¥—å‹åˆ¥ç³»çµ±å¯è®“ C é–‹ç™¼è€…é¡¯å¼è¡¨ç¤ºæ‰€æœ‰æ¬Šé—œä¿‚ï¼Œè®“è¨˜æ†¶é«”ç®¡ç†æ¨¡å¼æ–¼ API å±¤ç´šæ¸…æ™°æ­éœ²ã€‚

***

## ä¸»è¦ä½¿ç”¨ç¯„ä¾‹

### åˆå§‹åŒ–èˆ‡éŠ·æ¯€

åŸºæœ¬æ¨¡å¼æ˜¯å»ºç«‹èˆ‡éŠ·æ¯€è³‡æºï¼š

```c
// åˆå§‹åŒ–èˆ‡éŠ·æ¯€ç¯„ä¾‹
z_owned_string_t s;                           // æœªåˆå§‹åŒ–è¨˜æ†¶é«”
z_string_copy_from_str(&s, "Hello, world!");  // å¯«å…¥è³‡æ–™
z_drop(z_move(s));                            // z_move è½‰ç§»æ‰€æœ‰æ¬Š
                                              // z_drop å‘¼å« Rust çš„ destructor

```

`z_move()` å°‡æ‰€æœ‰æ¬Šå¾è®Šæ•¸è‡ªå‹•è½‰ç§»è‡³ `z_drop()`ï¼Œç¢ºä¿è³‡æºåƒ…æ¸…ç†ä¸€æ¬¡ã€‚

***

### è¤‡è£½ã€å€Ÿç”¨åŠå…‹éš†

ä¸åŒå‹åˆ¥ä¾åº•å±¤ Rust è¡Œç‚ºæœ‰ä¸åŒ clone èªæ„ï¼š

```c
// å­—ä¸²æ·±å±¤è¤‡è£½ç¯„ä¾‹
z_owned_string_t s1, s2;
z_string_copy_from_str(&s1, "Hello, world!");
z_string_clone(&s2, z_loan(s1));             // é€é z_loan é€²è¡Œæ·±æ‹·è²
z_drop(z_move(s1));                          // é‡‹æ”¾ s1
z_drop(z_move(s2));                          // é‡‹æ”¾ s2

// å¼•ç”¨è¨ˆæ•¸é¡å‹æ·ºè¤‡è£½ç¯„ä¾‹
z_owned_bytes_t b1, b2;
z_bytes_from_static_str(&b1, "Hello, world!");
z_bytes_clone(&b2, z_loan(b1));              // æ·ºå±¤è¤‡è£½ï¼ŒRust ä½¿ç”¨ Arc
z_drop(z_move(b1));                          // é‡‹æ”¾ b1
z_drop(z_move(b2));                          // æœ€å¾Œæ“æœ‰è€…é‡‹æ”¾è³‡æº

```
`z_loan()` å‡½å¼ç”¢ç”Ÿå€Ÿç”¨å¼•ç”¨ï¼Œé©ç”¨å”¯è®€æˆ– clone çš„ä¾†æºã€‚

***

### View ç‰©ä»¶ï¼ˆç„¡éœ€æ¸…ç†ï¼‰

View types ä»¥å †ç–Šé…ç½®æ–¹å¼å‘ˆç¾ï¼Œä½¿ç”¨å¾Œé›¢é–‹ä½œç”¨åŸŸè‡ªå‹•æ¸…é™¤ï¼š

```c
// View ç‰©ä»¶ä¸éœ€æ¸…ç†
z_owned_string_t owned;
z_string_copy_from_str(&owned, "Hello, world!");
z_view_string_t view;
z_view_string_from_str(&view, "Hello, another world!"); // stack-allocated
// view ä¸éœ€å‘¼å« dropï¼Œé›¢é–‹ä½œç”¨åŸŸè‡ªå‹•è™•ç†
```

***

### å‡½å¼å‘¼å«ä¸­ç§»å‹•èªç¾©ï¼ˆMove Semanticsï¼‰

Moved types ä½¿å‡½å¼é–“å®‰å…¨ä¸”æ˜ç¢ºåœ°è½‰ç§»æ‰€æœ‰æ¬Šï¼š

```c
// å–å¾—æ‰€æœ‰æ¬Šçš„å‡½å¼
void consume_string(z_moved_string_t* ps) {
    z_owned_string_t s;
    z_take(&s, ps);  // å¾ moved type å–å¾—æ‰€æœ‰æ¬Š
    printf("%.*s\n", z_string_len(z_loan(s)), z_string_data(z_loan(s)));
    z_drop(z_move(s));
}
// å‘¼å«ç«¯è½‰ç§»æ‰€æœ‰æ¬Š
z_owned_string_t s;
z_string_copy_from_str(&s, "Hello, world!");
consume_string(z_move(s));
// ä¸éœ€å¾ŒçºŒæ¸…ç†ï¼Œæ‰€æœ‰æ¬Šç§»è½‰çµ¦ consume_string
```

`z_take()` å¾ moved åƒæ•¸ä¸­å–å›æ“æœ‰å€¼ï¼Œä»¤æ‰€æœ‰æ¬Šè½‰ç§»é¡¯å¼ã€‚

***

### å¾ Loaned åƒè€ƒå–å¾—æ‰€æœ‰æ¬Š

callback å ´æ™¯å¸¸éœ€æ±‚å€Ÿç”¨è½‰ ownedï¼š

```c
// callback è½‰ owned
void sub_callback(z_loaned_sample_t* sample, void* arg) {
    z_owned_sample_t s;
    z_take_from_loaned(&s, sample);  // å¾å€Ÿç”¨çš„sampleä¸­å…‹éš†(Arc +1)
    // å¯å°‡ s å„²å­˜æˆ–ç§»å¾€å…¶ä»–åŸ·è¡Œç·’
}
z_owned_closure_sample_t callback;
z_closure(&callback, sub_callback, NULL, NULL);
z_owned_subscriber_t sub;
if (z_declare_subscriber(&sub, z_loan(session), z_loan(keyexpr),
                        z_move(callback), NULL) < 0) {
    printf("å®£å‘Š subscriber å¤±æ•—ã€‚\n");
    exit(-1);
}
```

æ­¤ç¨®ç”¨æ³•å°æ–¼callbackçš„æ“ä½œä¾†èªªå¯è¬‚æ˜¯ç›¸ç•¶éˆæ´»çš„ï¼

***

## é€²éšåŠŸèƒ½èˆ‡ç¯„ä¾‹

### Closure æ”¯æ´

Zenoh-c æ”¯æ´ C ç«¯æ³¨å†Š closureï¼š

```c
// C å›å‘¼å‡½å¼
void my_callback(const z_loaned_sample_t* sample, void* context) {
    printf("æ”¶åˆ°è³‡æ–™: %.*s\n",
           (int)z_bytes_len(z_sample_payload(sample)),
           z_bytes_data(z_sample_payload(sample)));
}
z_owned_closure_sample_t callback;
z_closure(&callback, my_callback, NULL, my_context);
z_subscriber_declare(&subscriber, z_loan(session), z_keyexpr("key"),
                    z_move(callback), NULL);
```

***

### é›¶æ‹·è²æ“ä½œ

åˆ©ç”¨ loan/borrow æ–¹å¼ä¿ç•™ Zenoh é›¶æ‹·è²ç‰¹æ€§ï¼š

```c
// å€Ÿç”¨è³‡æ–™ç„¡è¤‡è£½
const z_loaned_bytes_t* payload = z_sample_payload(z_loan(sample));
z_bytes_slice_t slice = z_bytes_get_slice(payload);
// ç›´æ¥ä½¿ç”¨ slice.start èˆ‡ slice.lenï¼Œç„¡é ˆè¤‡è£½
```

***

### æ³›å‹æ“ä½œ

æ³›å‹å·¨é›†ç³»çµ±æä¾›è·¨å‹åˆ¥çš„ type-safe æ“ä½œï¼š

```c
// é©ç”¨ä»»ä½• owned å‹åˆ¥
z_drop(z_move(session));    // å…§éƒ¨å‘¼å« z_session_drop
z_drop(z_move(subscriber)); // å…§éƒ¨å‘¼å« z_subscriber_drop
z_drop(z_move(publisher));  // å…§éƒ¨å‘¼å« z_publisher_drop
// Loan æ“ä½œåŒç†
const z_loaned_session_t* s = z_loan(session);
const z_loaned_keyexpr_t* k = z_loan(keyexpr);
```

***

## å¯¦éš›ä½¿ç”¨ç¯„ä¾‹

```c
#include "zenoh.h"
#include <stdio.h>

// è³‡æ–™è™•ç†çš„ callbackï¼Œæ¥æ”¶ sample ä¸¦å¾ä¸­æå– key åŠ payloadï¼Œç„¶å¾Œå°å‡º
void data_handler(const z_loaned_sample_t* sample, void* context) {
    z_owned_string_t key_str;  // å®£å‘Šç”¨æ–¼æ¥æ”¶ key çš„ owned string
    // å°‡ sample ä¸­çš„ keyexpr è½‰æˆå­—ä¸²ï¼Œå­˜å…¥ key_str
    z_keyexpr_to_string(z_sample_keyexpr(sample), &key_str);
    // å–å¾— sample payload çš„å€Ÿç”¨åƒè€ƒ
    const z_loaned_bytes_t* payload = z_sample_payload(sample);
    // å°å‡ºæ¥æ”¶åˆ°çš„ key èˆ‡ payload çš„å…§å®¹
    printf("Received: %.*s => %.*s\n",
           (int)z_string_len(z_loan(key_str)), z_string_data(z_loan(key_str)),
           (int)z_bytes_len(payload), z_bytes_data(payload));
    // é‡‹æ”¾ key_str æ‰€æ“æœ‰çš„è³‡æºï¼šç”¨ z_move å°‡æ‰€æœ‰æ¬Šè½‰çµ¦ z_dropï¼Œç¢ºä¿è³‡æ–™æ­£ç¢ºé‡‹æ”¾
    z_drop(z_move(key_str));
}

// ç•¶éœ€è¦æ¸…ç† context æ™‚å‘¼å«æ­¤å‡½å¼ï¼ˆæ­¤ç¯„ä¾‹ä¸­æœªä½¿ç”¨ä»»ä½• contextï¼‰
void drop_handler(void* context) {
    // å¦‚éœ€æ¸…ç† contextï¼Œå¯åœ¨æ­¤å¯¦ä½œ
}

int main() {
    // å®£å‘Šä¸¦åˆå§‹åŒ– configï¼Œé©ç”¨æ–¼å»ºç«‹ Session
    z_owned_config_t config;
    z_config_default(&config);  // å»ºç«‹é è¨­è¨­å®š

    // å»ºç«‹ä¸€å€‹ owned sessionï¼Œä½¿ç”¨ z_move æŠŠ config çš„æ‰€æœ‰æ¬Šè½‰å‡º
    z_owned_session_t session;
    if (z_open(&session, z_move(config)) < 0) {
        printf("Unable to open session!\n"); // é–‹å•Ÿå¤±æ•—é¡¯ç¤ºéŒ¯èª¤
        return -1;
    }

    // å»ºç«‹ä¸€å€‹ owned closure sampleï¼Œå°‡ data_handler èˆ‡ drop_handler è¨»å†Šç‚ºå›å‘¼
    z_owned_closure_sample_t callback;
    z_closure(&callback, data_handler, drop_handler, NULL);

    // å®£å‘Š subscriber ä¸¦å»ºç«‹ key è¡¨é”å¼ï¼Œç”¨æ–¼è¨‚é–±çš„æŸ¥è©¢
    z_owned_subscriber_t sub;
    z_view_keyexpr_t keyexpr;
    z_view_keyexpr_from_str(&keyexpr, "demo/example");  // å¾å­—ä¸²ç”¢ç”Ÿæª¢è¦–å‹ keyexpr

    // å»ºç«‹è¨‚é–±è€…ï¼Œä½¿ç”¨ z_loan å–å¾— session å’Œ keyexpr çš„å€Ÿç”¨åƒè€ƒï¼Œ
    // ç”¨ z_move è½‰ç§» callback çš„æ‰€æœ‰æ¬Šåˆ°è¨‚é–±è€…
    if (z_declare_subscriber(&sub, z_loan(session), z_loan(keyexpr),
                            z_move(callback), NULL) < 0) {
        printf("Unable to declare subscriber!\n");  // å»ºç«‹å¤±æ•—æ™‚éŒ¯èª¤è¼¸å‡º
        z_drop(z_move(session));                    // é‡‹æ”¾ sessionï¼Œé¿å…è³‡æºæ´©æ¼
        return -1;
    }

    // å®£å‘Šç™¼å¸ƒè€…
    z_owned_publisher_t pub;
    // ç”¢ç”Ÿç™¼å¸ƒè€…ï¼Œä½¿ç”¨å€Ÿç”¨åƒè€ƒ session å’Œ keyexpr
    if (z_declare_publisher(&pub, z_loan(session), z_loan(keyexpr), NULL) < 0) {
        printf("Unable to declare publisher!\n");
        z_drop(z_move(sub));     // é‡‹æ”¾è¨‚é–±è€…
        z_drop(z_move(session)); // é‡‹æ”¾ session
        return -1;
    }

    // å»ºç«‹ payload ä¸¦å¾å­—ä¸²åˆå§‹åŒ–ï¼Œä¸éœ€è‡ªå·±ç®¡ç†è¨˜æ†¶é«”
    z_owned_bytes_t payload;
    z_bytes_from_static_str(&payload, "Hello, Zenoh!");

    // é€é publisher ç™¼å¸ƒè³‡æ–™ï¼Œz_move è½‰ç§» payload æ‰€æœ‰æ¬Šï¼Œå‡½å¼æœƒè‡ªå‹•ç®¡ç†é‡‹æ”¾
    z_publisher_put(z_loan(pub), z_move(payload), NULL);

    // ç¨‹å¼æš«åœä¸€ç§’ï¼Œä¿æŒé‹ä½œï¼Œç¢ºä¿è¨Šæ¯é€å‡º
    z_sleep_s(1);

    // æ¸…ç†è³‡æºï¼Œé‡‹æ”¾é †åºèˆ‡å»ºç«‹ç›¸å
    z_drop(z_move(pub));
    z_drop(z_move(sub));
    z_drop(z_move(session));

    return 0;
}
```

***

## åˆ°æ­¤çˆ²æ­¢ï¼Œæˆ‘å€‘çœŸçš„å®‰å…¨äº†å—ï¼Ÿ

å„˜ç®¡æ“æœ‰è¤‡é›œå‹åˆ¥ç³»çµ±èˆ‡è‡ªå‹•ç”ŸæˆæŠ€è¡“ï¼Œzenoh-c åœ¨ C è¨˜æ†¶é«”æ¨¡å‹çš„æ ¹æœ¬é™åˆ¶ä¸­ä»é¢è‡¨æŒ‘æˆ°ï¼Œå…¶ç­–ç•¥å¦èª é¢å°æ­¤å•é¡Œï¼Œä¹Ÿé¡¯è‘—æ”¹å–„å‚³çµ± C API çš„å®‰å…¨é¢¨éšªã€‚

### å°šå­˜å®‰å…¨æ€§çš„å•é¡Œ

1. **Use After Free** ï¼šC ç«¯ä»å¯èƒ½åœ¨å‘¼å« `z_drop()` å¾Œå­˜å–è³‡æ–™ï¼Œä½†ç‰©ä»¶æœƒè¢«è¨­ç‚ºç‰¹æ®Š â€œgravestoneâ€ ç‹€æ…‹ä¾†å¹«åŠ© Lint éŒ¯èª¤
2. **Invalid Drop** ï¼šå°æœªåˆå§‹åŒ–ç‰©ä»¶å‘¼å« `z_drop()` å¯èƒ½å°è‡´ undefined behaviorï¼Œå¯æƒœçš„æ˜¯C ç„¡æ³•å€åˆ†æœªåˆå§‹åŒ–èˆ‡åˆæ³•å…§å®¹
3. **Resource Leaks** ï¼šç‰©ä»¶è¦†å¯«å‰æœªæ­£ç¢ºé‡‹æ”¾ï¼Œå°è‡´è³‡æºéºæ¼ï¼Œå›  C ä¸¦ç„¡ç„¡è‡ªå‹•è§£æ§‹å­

### è§£æ³•

zenoh-c æ¡ç”¨å¤šé …ç­–ç•¥é™ä½é¢¨éšªï¼š
- **Gravestone Pattern**ï¼šè¢«é‡‹æ”¾ç‰©ä»¶æ¨™ç¤ºç‚ºå¯è¾¨è­˜çš„ç‹€æ…‹ï¼Œæ–¹ä¾¿åµéŒ¯
- **Type-Based Safety**ï¼šå‹åˆ¥ç³»çµ±é€ééœæ…‹æª¢æŸ¥èˆ‡æ˜ç¢ºæ‰€æœ‰æ¬Šèªæ„é™ä½éŒ¯èª¤
- **Clear Ownership Transfer**ï¼šåˆ©ç”¨ `z_move()` æ˜ç¤ºæ‰€æœ‰æ¬Šè½‰ç§»
- **é©—è­‰å‡½å¼** (`z_internal_check()`)ï¼šåŸ·è¡Œä¸­æª¢é©—ç‰©ä»¶æœ‰æ•ˆæ€§
- **å®Œå–„æ¸¬è©¦**ï¼šè¦†è“‹å¸¸è¦‹éŒ¯èª¤èˆ‡ä¸€è‡´æ€§é©—è­‰
- **æ¸…æ™°æ–‡ä»¶èˆ‡ç¯„ä¾‹**ï¼šå”åŠ©é–‹ç™¼è€…éµå®ˆæ­£ç¢ºç”¨æ³•

### C èªè¨€å®‰å…¨çš„ç¾å¯¦

é€™äº›æ‰‹æ®µé¡¯è‘—æå‡å®‰å…¨ï¼Œä½†ç„¡æ³•èˆ‡ Rust ç·¨è­¯æœŸ borrow checker ç›¸æä¸¦è«–ã€‚ç›®æ¨™æ˜¯**ä½¿æ­£ç¢ºç”¨æ³•æ˜“æ–¼åŸ·è¡Œï¼ŒéŒ¯èª¤ç”¨æ³•é¡¯è€Œæ˜“è¦‹**ï¼Œè€Œéå®Œå…¨é˜²æ­¢éŒ¯èª¤ã€‚

Zenoh-c å¯¦ç¾å‹™å¯¦å¹³è¡¡ï¼Œåœ¨ç¶­æŒç†Ÿæ‚‰ç”¨æ³•èˆ‡é«˜æ•ˆèƒ½ä¹‹é¤˜ï¼Œç›¡å¯èƒ½æä¾›æœ€å¤§å®‰å…¨ä¿éšœã€‚

***

## æ•ˆèƒ½èˆ‡äººé«”å·¥å­¸

### é›¶é¡å¤–é–‹éŠ·æŠ½è±¡

å„˜ç®¡å‹åˆ¥ç³»çµ±è¤‡é›œï¼Œzenoh-c ä¿æŒé›¶åŸ·è¡Œæ™‚é¡å¤–é–‹éŠ·ï¼š
- **ç·¨è­¯æ™‚è§£æ**ï¼šæ³›å‹å®è½‰è­¯ç‚ºç›´æ¥å‡½å¼èª¿ç”¨
- **å…§è¯æ“ä½œ**ï¼šmove èˆ‡ loan æ¸›å°‘ç‚ºæŒ‡æ¨™ç®—è¡“
- **ä¸éœ€ boxing**ï¼šopaque types èˆ‡ Rust åŸå‹å¤§å°å’Œå°é½Šç›¸åŒ

### åœ¨ C++ ä¸Šæ›´ä¸Šä¸€å±¤æ¨“

æ³›å‹å®ç³»çµ±(generic macro system) åœ¨ C++ å¯çµåˆå‡½å¼å¤šè¼‰ç”¨æ³•ï¼š

```cpp
// C++ å¯ç”¨å‡½å¼å¤šè¼‰ï¼Œèªæ³•æ›´ç°¡æ½”
z_drop(std::move(session));    // ç„¡é ˆä½¿ç”¨ z_move()
auto loaned = z_loan(keyexpr); // é¡å‹è‡ªå‹•æ¨å°
```

***

## çµèª

zenoh-c ç¶å®šç³»çµ±å±•ç¤ºé€éç²¾å¿ƒè¨­è¨ˆèˆ‡è‡ªå‹•åŒ–å·¥å…·å¯åœ¨ C API ä¸­å¤§å¹…æå‡è¨˜æ†¶é«”å®‰å…¨ã€‚å„˜ç®¡ç„¡æ³•æ¶ˆé™¤ C æœ¬è³ªçš„æ‰€æœ‰å®‰å…¨ç¼ºé™·ï¼Œä½†å¯è®“æ­£ç¢ºä½¿ç”¨æ›´è‡ªç„¶ï¼ŒéŒ¯èª¤æ˜ç¢ºã€‚

å°ˆæ¡ˆå¦èª å®‰å…¨æŒ‘æˆ°èˆ‡å¯¦å‹™ç·©è§£ç­–ç•¥ï¼Œç‚ºç¾ä»£ç³»çµ±ç¨‹å¼èªè¨€èˆ‡å‚³çµ± C ç¨‹å¼ç¢¼åº«æ©‹æ¥æä¾›å¯è¡Œç¤ºç¯„ã€‚

æ ¸å¿ƒå•Ÿç¤ºæ˜¯ï¼šå¾¹åº•çš„å®‰å…¨ä¹Ÿè¨±ç„¡æ³•å®Œç¾é”æˆï¼Œä½†é€éæ˜ç¢ºæ‰€æœ‰æ¬Šã€å·¥å…·è‡ªå‹•åŒ–èˆ‡æ…å¯†è¨­è¨ˆèƒ½å¤§å¹…æå‡ã€‚

C èªè¨€æ ¹æœ¬é™åˆ¶ä»å­˜åœ¨éƒ¨åˆ†å®‰å…¨æŒ‘æˆ°ï¼Œå¾…ç¬¬ 3 éƒ¨åˆ†å°‡è«–åŠ zenoh-cpp è—‰ç”± RAIIã€æ¨¡æ¿èˆ‡ C++ å‹åˆ¥ç³»çµ±ï¼Œæ¶ˆé™¤æ›´å¤šå®‰å…¨é¢¨éšªï¼ŒåŒæ™‚ä¿æœ‰ Rust å¯¦ä½œæ•ˆèƒ½ã€‚

***

ğŸ‘‰ æ•¬è«‹æœŸå¾…ç¬¬ 3 éƒ¨åˆ†ï¼Œæˆ‘å€‘å°‡æ¢è¨Zenoh ä¸­å¦‚ä½•éˆæ´»é‹ç”¨ç¾ä»£åŒ–çš„ C++ APIã€‚
